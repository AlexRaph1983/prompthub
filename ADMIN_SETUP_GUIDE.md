# Руководство по настройке админ-панели PromptHub

## Настройка админского доступа

### Метод 1: Через переменную окружения (простой)

1. В файле `.env` добавьте переменную:
```bash
ADMIN_EMAIL=your-email@example.com
```

2. Войдите на сайт через Google OAuth с указанным email
3. Перейдите на `/admin` - у вас будут полные права супер-админа

### Метод 2: Через базу данных (расширенный)

1. Создайте запись в таблице `AdminUser`:
```sql
INSERT INTO AdminUser (id, userId, role, permissions, createdAt, updatedAt) 
VALUES (
  'admin-1', 
  'user-id-from-users-table', 
  'super_admin',
  '{"prompts_view":true,"prompts_moderate":true,"prompts_delete":true,"prompts_edit":true,"users_view":true,"users_manage":true,"users_ban":true,"analytics_view":true,"analytics_export":true,"system_settings":true,"admin_manage":true}',
  datetime('now'),
  datetime('now')
);
```

## Доступ к админ-панели

После настройки админского доступа:

1. Войдите на сайт через Google OAuth
2. Перейдите на `/admin`
3. Вы увидите админ-панель с навигацией

## Функции админ-панели

### Дашборд (`/admin`)
- Общая статистика сайта
- Графики роста пользователей
- Топ промпты и поисковые запросы
- Последняя активность

### Управление промптами (`/admin/prompts`)
- Просмотр всех промптов
- Поиск и фильтрация
- Модерация и удаление промптов
- Массовые операции

### Аналитика поиска (`/admin/search-analytics`)
- Статистика поисковых запросов
- Популярные запросы
- Запросы без результатов (для улучшения контента)
- Экспорт данных в CSV

## Роли и разрешения

### Модератор (moderator)
- Просмотр и модерация промптов
- Удаление неподходящих промптов
- Просмотр аналитики

### Администратор (admin)
- Все права модератора
- Управление пользователями
- Экспорт данных
- Системные настройки

### Супер-администратор (super_admin)
- Все права администратора
- Управление другими админами
- Полный доступ ко всем функциям

## Отслеживание поисковых запросов

Система автоматически отслеживает:
- Все поисковые запросы пользователей
- Количество найденных результатов
- Клики по результатам поиска
- Анонимные и авторизованные поиски

Данные используются для:
- Анализа популярных тем
- Выявления пробелов в контенте
- Улучшения алгоритма поиска

## Безопасность

- Все админские API защищены проверкой разрешений
- Логирование всех действий админов
- Хэширование IP-адресов для анонимных пользователей
- Разделение ролей и ограничение доступа

## Техническая информация

### База данных
Новые таблицы:
- `SearchQuery` - поисковые запросы
- `AdminUser` - админские пользователи

### API эндпоинты
- `GET /api/admin/dashboard` - данные дашборда
- `GET /api/admin/prompts` - список промптов для модерации
- `DELETE /api/admin/prompts?id=` - удаление промпта
- `GET /api/admin/search-analytics` - аналитика поиска
- `POST /api/search-tracking` - отслеживание поисковых запросов

### Компоненты
- `AdminLayout` - общий layout админ-панели
- `AdminNavigation` - навигация с проверкой разрешений
- `AdminDashboard` - главная страница
- `AdminPromptManagement` - управление промптами
- `AdminSearchAnalytics` - аналитика поиска
